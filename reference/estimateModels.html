<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Estimate the same model on different size subsets of a data set — estimateModels • conjointTools</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Estimate the same model on different size subsets of a data set — estimateModels" />
<meta property="og:description" content="This function estimates the same model multiple times using different size
subsets of a set of choice data. The number of models to run is set by the
nbreaks argument, which breaks up the data into groups of increasing
sample sizes. All models are estimated models using the logitr package." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">conjointTools</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.7.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/jhelvy/conjointTools">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Estimate the same model on different size subsets of a data set</h1>
    <small class="dont-index">Source: <a href='https://github.com/jhelvy/conjointTools/blob/master/R/estimateModels.R'><code>R/estimateModels.R</code></a></small>
    <div class="hidden name"><code>estimateModels.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function estimates the same model multiple times using different size
subsets of a set of choice data. The number of models to run is set by the
<code>nbreaks</code> argument, which breaks up the data into groups of increasing
sample sizes. All models are estimated models using the logitr package.</p>
    </div>

    <pre class="usage"><span class='fu'>estimateModels</span><span class='op'>(</span>
  nbreaks <span class='op'>=</span> <span class='fl'>10</span>,
  <span class='va'>data</span>,
  <span class='va'>outcome</span>,
  <span class='va'>obsID</span>,
  <span class='va'>pars</span>,
  price <span class='op'>=</span> <span class='cn'>NULL</span>,
  randPars <span class='op'>=</span> <span class='cn'>NULL</span>,
  randPrice <span class='op'>=</span> <span class='cn'>NULL</span>,
  modelSpace <span class='op'>=</span> <span class='st'>"pref"</span>,
  weights <span class='op'>=</span> <span class='cn'>NULL</span>,
  panelID <span class='op'>=</span> <span class='cn'>NULL</span>,
  clusterID <span class='op'>=</span> <span class='cn'>NULL</span>,
  robust <span class='op'>=</span> <span class='cn'>FALSE</span>,
  startParBounds <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>1</span>, <span class='fl'>1</span><span class='op'>)</span>,
  startVals <span class='op'>=</span> <span class='cn'>NULL</span>,
  numMultiStarts <span class='op'>=</span> <span class='fl'>1</span>,
  useAnalyticGrad <span class='op'>=</span> <span class='cn'>TRUE</span>,
  scaleInputs <span class='op'>=</span> <span class='cn'>TRUE</span>,
  standardDraws <span class='op'>=</span> <span class='cn'>NULL</span>,
  numDraws <span class='op'>=</span> <span class='fl'>50</span>,
  vcov <span class='op'>=</span> <span class='cn'>FALSE</span>,
  predict <span class='op'>=</span> <span class='cn'>FALSE</span>,
  options <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>print_level <span class='op'>=</span> <span class='fl'>0</span>, xtol_rel <span class='op'>=</span> <span class='fl'>1e-06</span>, xtol_abs <span class='op'>=</span> <span class='fl'>1e-06</span>, ftol_rel <span class='op'>=</span> <span class='fl'>1e-06</span>,
    ftol_abs <span class='op'>=</span> <span class='fl'>1e-06</span>, maxeval <span class='op'>=</span> <span class='fl'>1000</span>, algorithm <span class='op'>=</span> <span class='st'>"NLOPT_LD_LBFGS"</span><span class='op'>)</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>nbreaks</th>
      <td><p>The number of different sample size groups.</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>The data, formatted as a <code>data.frame</code> object.</p></td>
    </tr>
    <tr>
      <th>outcome</th>
      <td><p>The name of the column that identifies the outcome variable,
which should be coded with a <code>1</code> for <code>TRUE</code> and <code>0</code> for <code>FALSE</code>.</p></td>
    </tr>
    <tr>
      <th>obsID</th>
      <td><p>The name of the column that identifies each observation.</p></td>
    </tr>
    <tr>
      <th>pars</th>
      <td><p>The names of the parameters to be estimated in the model.
Must be the same as the column names in the <code>data</code> argument. For WTP space
models, do not include price in <code>pars</code>.</p></td>
    </tr>
    <tr>
      <th>price</th>
      <td><p>The name of the column that identifies the price variable.
Required for WTP space models. Defaults to <code>NULL</code>.</p></td>
    </tr>
    <tr>
      <th>randPars</th>
      <td><p>A named vector whose names are the random parameters and
values the distribution: <code>'n'</code> for normal or <code>'ln'</code> for log-normal.
Defaults to <code>NULL</code>.</p></td>
    </tr>
    <tr>
      <th>randPrice</th>
      <td><p>The random distribution for the price parameter: <code>'n'</code> for
normal or <code>'ln'</code> for log-normal. Only used for WTP space MXL models.
Defaults to <code>NULL</code>.</p></td>
    </tr>
    <tr>
      <th>modelSpace</th>
      <td><p>Set to <code>'wtp'</code> for WTP space models. Defaults to <code>"pref"</code>.</p></td>
    </tr>
    <tr>
      <th>weights</th>
      <td><p>The name of the column that identifies the weights to be
used in model estimation. Defaults to <code>NULL</code>.</p></td>
    </tr>
    <tr>
      <th>panelID</th>
      <td><p>The name of the column that identifies the individual (for
panel data where multiple observations are recorded for each individual).
Defaults to <code>NULL</code>.</p></td>
    </tr>
    <tr>
      <th>clusterID</th>
      <td><p>The name of the column that identifies the cluster
groups to be used in model estimation. Defaults to <code>NULL</code>.</p></td>
    </tr>
    <tr>
      <th>robust</th>
      <td><p>Determines whether or not a robust covariance matrix is
estimated. Defaults to <code>FALSE</code>. Specification of a <code>clusterID</code> or
<code>weights</code> will override the user setting and set this to `TRUE' (a
warning will be displayed in this case). Replicates the functionality of
Stata's cmcmmixlogit.</p></td>
    </tr>
    <tr>
      <th>startParBounds</th>
      <td><p>sets the <code>lower</code> and <code>upper</code> bounds for the starting
parameters for each optimization run, which are generated by
<code><a href='https://rdrr.io/r/stats/Uniform.html'>runif(n, lower, upper)</a></code>. Defaults to <code><a href='https://rdrr.io/r/base/c.html'>c(-1, 1)</a></code>.</p></td>
    </tr>
    <tr>
      <th>startVals</th>
      <td><p>is vector of values to be used as starting values for the
optimization. Only used for the first run if <code>numMultiStarts &gt; 1</code>. Defaults
to <code>NULL</code>.</p></td>
    </tr>
    <tr>
      <th>numMultiStarts</th>
      <td><p>is the number of times to run the optimization loop,
each time starting from a different random starting point for each parameter
between <code>startParBounds</code>. Recommended for non-convex models, such as WTP
space models and mixed logit models. Defaults to <code>1</code>.</p></td>
    </tr>
    <tr>
      <th>useAnalyticGrad</th>
      <td><p>Set to <code>FALSE</code> to use numerically approximated
gradients instead of analytic gradients during estimation. For now, using
the analytic gradient is faster for MNL models but slower for MXL models.
Defaults to <code>TRUE</code>.</p></td>
    </tr>
    <tr>
      <th>scaleInputs</th>
      <td><p>By default each variable in <code>data</code> is scaled to be
between 0 and 1 before running the optimization routine because it usually
helps with stability, especially if some of the variables have very large or
very small values (e.g. <code>&gt; 10^3</code> or <code>&lt; 10^-3</code>). Set to <code>FALSE</code> to turn this
feature off. Defaults to <code>TRUE</code>.</p></td>
    </tr>
    <tr>
      <th>standardDraws</th>
      <td><p>By default, a new set of standard normal draws are
generated during each call to <code>logitr</code> (the same draws are used during each
multistart iteration). The user can override those draws by providing a
matrix of standard normal draws if desired. Defaults to <code>NULL</code>.</p></td>
    </tr>
    <tr>
      <th>numDraws</th>
      <td><p>The number of Halton draws to use for MXL models for the
maximum simulated likelihood. Defaults to <code>50</code>.</p></td>
    </tr>
    <tr>
      <th>vcov</th>
      <td><p>Set to <code>TRUE</code> to evaluate and include the variance-covariance
matrix and coefficient standard errors in the returned object.
Defaults to <code>FALSE</code>.</p></td>
    </tr>
    <tr>
      <th>predict</th>
      <td><p>If <code>FALSE</code>, predicted probabilities, fitted values, and
residuals are not included in the returned object. Defaults to <code>TRUE</code>.</p></td>
    </tr>
    <tr>
      <th>options</th>
      <td><p>A list of options for controlling the <code>nloptr()</code> optimization.
Run <code><a href='https://rdrr.io/pkg/nloptr/man/nloptr.print.options.html'>nloptr::nloptr.print.options()</a></code> for details.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Returns a nested data frame with each estimated model object in
the <code>model</code> column.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/jhelvy/conjointTools'>conjointTools</a></span><span class='op'>)</span>

<span class='co'># Define the attributes and levels</span>
<span class='va'>levels</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>
  price     <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>4</span>, <span class='fl'>0.5</span><span class='op'>)</span>, <span class='co'># $ per pound</span>
  type      <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'Fuji'</span>, <span class='st'>'Gala'</span>, <span class='st'>'Honeycrisp'</span>, <span class='st'>'Pink Lady'</span>, <span class='st'>'Red Delicious'</span><span class='op'>)</span>,
  freshness <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'Excellent'</span>, <span class='st'>'Average'</span>, <span class='st'>'Poor'</span><span class='op'>)</span>
<span class='op'>)</span>

<span class='co'># Make a full-factorial design of experiment and recode the levels</span>
<span class='va'>doe</span> <span class='op'>&lt;-</span> <span class='fu'><a href='makeDoe.html'>makeDoe</a></span><span class='op'>(</span><span class='va'>levels</span><span class='op'>)</span>
<span class='va'>doe</span> <span class='op'>&lt;-</span> <span class='fu'><a href='recodeDesign.html'>recodeDesign</a></span><span class='op'>(</span><span class='va'>doe</span>, <span class='va'>levels</span><span class='op'>)</span>

<span class='co'># Make the survey</span>
<span class='va'>survey</span> <span class='op'>&lt;-</span> <span class='fu'><a href='makeSurvey.html'>makeSurvey</a></span><span class='op'>(</span>
    doe       <span class='op'>=</span> <span class='va'>doe</span>,  <span class='co'># Design of experiment</span>
    nResp     <span class='op'>=</span> <span class='fl'>2000</span>, <span class='co'># Total number of respondents (upper bound)</span>
    nAltsPerQ <span class='op'>=</span> <span class='fl'>3</span>,    <span class='co'># Number of alternatives per question</span>
    nQPerResp <span class='op'>=</span> <span class='fl'>6</span>     <span class='co'># Number of questions per respondent</span>
<span class='op'>)</span>

<span class='co'># Simulate random choices for the survey</span>
<span class='va'>data</span> <span class='op'>&lt;-</span> <span class='fu'><a href='simulateChoices.html'>simulateChoices</a></span><span class='op'>(</span>
    survey <span class='op'>=</span> <span class='va'>survey</span>,
    obsID  <span class='op'>=</span> <span class='st'>"obsID"</span>
<span class='op'>)</span>

<span class='co'># Estimate models with different sample sizes</span>
<span class='va'>models</span> <span class='op'>&lt;-</span> <span class='fu'>estimateModels</span><span class='op'>(</span>
    nbreaks <span class='op'>=</span> <span class='fl'>10</span>,
    data    <span class='op'>=</span> <span class='va'>data</span>,
    pars    <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"price"</span>, <span class='st'>"type"</span>, <span class='st'>"freshness"</span><span class='op'>)</span>,
    outcome <span class='op'>=</span> <span class='st'>"choice"</span>,
    obsID   <span class='op'>=</span> <span class='st'>"obsID"</span>
<span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='warning'>Warning: all scheduled cores encountered errors in user code</span></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by John Helveston.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


